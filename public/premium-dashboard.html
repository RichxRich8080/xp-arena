<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Premium Hub ‚Ä¢ XP ARENA</title>
  <link rel="stylesheet" href="css/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/fontawesome/css/all.min.css">
</head>

<body class="fade-in">
  <nav class="navbar"></nav>
  <main class="main-content-area">
    <div class="container">
      <div class="page-header">
        <h1>Premium Hub</h1>
        <p>Customization, creator tools, and quick stats</p>
      </div>
      <div class="stats-grid" id="pStats" style="margin-bottom:1rem;"></div>
      <div class="form-card">
        <h3 style="margin-bottom:0.8rem;">Recent Activity</h3>
        <div id="pActivity" style="display:grid; gap:8px;"></div>
      </div>
      <div class="form-card" style="margin-top:1rem;">
        <h3 style="margin-bottom:0.8rem;">My Setups</h3>
        <div id="pSetups" style="display:grid; gap:8px;"></div>
      </div>
      <div class="form-card" style="margin-top:1rem; display:flex; gap:10px; flex-wrap:wrap;">
        <a class="btn-secondary" style="width:auto" href="premium.html"><i class="fas fa-gem"></i> Plan & Benefits</a>
        <a class="btn-secondary" style="width:auto" href="creators.html"><i class="fas fa-user-astronaut"></i> Creator
          Dashboard</a>
        <a class="btn-secondary" style="width:auto" href="tool.html#manual"><i class="fas fa-sliders-h"></i> Manual
          Setups</a>
      </div>
    </div>
  </main>
  <nav class="bottom-nav"></nav>
  <script src="js/auth.js"></script>
  <script src="js/user.js"></script>
  <script src="js/layout.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', initPremium);
    async function initPremium() {
      if (!Auth.isLoggedIn()) { window.location.href = 'login.html'; return; }
      try {
        const res = await fetch((window.API_URL || '') + '/api/user/profile', { headers: { 'Authorization': 'Bearer ' + Auth.getToken() } });
        if (!res.ok) { document.getElementById('pStats').innerHTML = '<div class=\"form-card\">Error loading profile</div>'; return; }
        const data = await res.json();
        const u = data.user;
        document.getElementById('pStats').innerHTML = [
          { label: 'AXP', val: (u.axp || 0).toLocaleString() },
          { label: 'Rank', val: (Math.floor((u.axp || 0) / 500) + 1) },
          { label: 'Streak', val: (u.streak || 0) + 'd' },
          { label: 'Premium', val: (u.is_premium ? 'Yes' : 'No') }
        ].map(x => `<div><span class="stat-val">${x.val}</span><span class="stat-label">${x.label}</span></div>`).join('');
        const acts = (data.activities || []).slice(0, 20).map(a => `
          <div class="form-card" style="padding:0.8rem 1rem; display:grid; grid-template-columns: 1fr auto;">
            <div>${a.text}</div><div style="color: var(--text-muted); font-size:0.85rem;">${new Date(a.timestamp).toLocaleString()}</div>
          </div>`).join('');
        document.getElementById('pActivity').innerHTML = acts || '<div class="form-card">No activity yet.</div>';
        // Fetch my setups
        const setupsRes = await fetch((window.API_URL || '') + '/api/setups/user', { headers: { 'Authorization': 'Bearer ' + Auth.getToken() } });
        const setups = setupsRes.ok ? await setupsRes.json() : [];
        document.getElementById('pSetups').innerHTML = setups.map(s => `
          <div class="form-card" style="display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center;">
            <div>${s.mode.toUpperCase()} ‚Äî Gen ${s.general}, Red ${s.reddot}, 2x ${s.scope2x}, 4x ${s.scope4x}, 8x ${s.scope8x}<br>
            <span style="font-size:0.85rem; color: var(--text-muted);">${new Date(s.created_at).toLocaleString()}</span></div>
            <div style="font-size:0.85rem; color: var(--text-muted);">‚ù§Ô∏è ${s.likes} ‚Ä¢ üìã ${s.copies}</div>
          </div>`).join('') || '<div class="form-card">No setups found.</div>';
      } catch { }
    }
  </script>
</body>

</html>